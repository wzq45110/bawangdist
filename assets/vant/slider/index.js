"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var component_1 = require('./../common/component.js');
var touch_1 = require('./../mixins/touch.js');
var utils_1 = require('./../common/utils.js');
component_1.VantComponent({
    mixins: [touch_1.touch],
    props: {
        disabled: Boolean,
        useButtonSlot: Boolean,
        activeColor: String,
        inactiveColor: String,
        max: {
            type: Number,
            value: 100
        },
        min: {
            type: Number,
            value: 0
        },
        step: {
            type: Number,
            value: 1
        },
        value: {
            type: Number,
            value: 0
        },
        barHeight: {
            type: null,
            value: '2px'
        }
    },
    watch: {
        value: function value(_value) {
            this.updateValue(_value, false);
        }
    },
    created: function created() {
        this.updateValue(this.data.value);
    },
    methods: {
        onTouchStart: function onTouchStart(event) {
            if (this.data.disabled) return;
            this.touchStart(event);
            this.startValue = this.format(this.data.value);
            this.dragStatus = 'start';
        },
        onTouchMove: function onTouchMove(event) {
            var _this = this;
            if (this.data.disabled) return;
            if (this.dragStatus === 'start') {
                this.$emit('drag-start');
            }
            this.touchMove(event);
            this.dragStatus = 'draging';
            this.getRect('.van-slider').then(function (rect) {
                var diff = _this.deltaX / rect.width * 100;
                _this.newValue = _this.startValue + diff;
                _this.updateValue(_this.newValue, false, true);
            });
        },
        onTouchEnd: function onTouchEnd() {
            if (this.data.disabled) return;
            if (this.dragStatus === 'draging') {
                this.updateValue(this.newValue, true);
                this.$emit('drag-end');
            }
        },
        onClick: function onClick(event) {
            var _this = this;
            if (this.data.disabled) return;
            var min = this.data.min;
            this.getRect('.van-slider').then(function (rect) {
                var value = (event.detail.x - rect.left) / rect.width * _this.getRange() + min;
                _this.updateValue(value, true);
            });
        },
        updateValue: function updateValue(value, end, drag) {
            value = this.format(value);
            var _a = this.data,
                barHeight = _a.barHeight,
                min = _a.min;
            var width = (value - min) * 100 / this.getRange() + "%";
            this.setData({
                value: value,
                barStyle: "width: " + width + "; height: " + utils_1.addUnit(barHeight) + ";"
            });
            if (drag) {
                this.$emit('drag', { value: value });
            }
            if (end) {
                this.$emit('change', value);
            }
        },
        getRange: function getRange() {
            var _a = this.data,
                max = _a.max,
                min = _a.min;
            return max - min;
        },
        format: function format(value) {
            var _a = this.data,
                max = _a.max,
                min = _a.min,
                step = _a.step;
            return Math.round(Math.max(min, Math.min(value, max)) / step) * step;
        }
    }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY29tcG9uZW50XzEiLCJyZXF1aXJlIiwidG91Y2hfMSIsInV0aWxzXzEiLCJWYW50Q29tcG9uZW50IiwibWl4aW5zIiwidG91Y2giLCJwcm9wcyIsImRpc2FibGVkIiwiQm9vbGVhbiIsInVzZUJ1dHRvblNsb3QiLCJhY3RpdmVDb2xvciIsIlN0cmluZyIsImluYWN0aXZlQ29sb3IiLCJtYXgiLCJ0eXBlIiwiTnVtYmVyIiwibWluIiwic3RlcCIsImJhckhlaWdodCIsIndhdGNoIiwidXBkYXRlVmFsdWUiLCJjcmVhdGVkIiwiZGF0YSIsIm1ldGhvZHMiLCJvblRvdWNoU3RhcnQiLCJldmVudCIsInRvdWNoU3RhcnQiLCJzdGFydFZhbHVlIiwiZm9ybWF0IiwiZHJhZ1N0YXR1cyIsIm9uVG91Y2hNb3ZlIiwiX3RoaXMiLCIkZW1pdCIsInRvdWNoTW92ZSIsImdldFJlY3QiLCJ0aGVuIiwicmVjdCIsImRpZmYiLCJkZWx0YVgiLCJ3aWR0aCIsIm5ld1ZhbHVlIiwib25Ub3VjaEVuZCIsIm9uQ2xpY2siLCJkZXRhaWwiLCJ4IiwibGVmdCIsImdldFJhbmdlIiwiZW5kIiwiZHJhZyIsIl9hIiwic2V0RGF0YSIsImJhclN0eWxlIiwiYWRkVW5pdCIsIk1hdGgiLCJyb3VuZCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBQ0FBLE9BQU9DLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDLEVBQUVDLE9BQU8sSUFBVCxFQUE3QztBQUNBLElBQUlDLGNBQWNDLFFBQVEscUJBQVIsQ0FBbEI7QUFDQSxJQUFJQyxVQUFVRCxRQUFRLGlCQUFSLENBQWQ7QUFDQSxJQUFJRSxVQUFVRixRQUFRLGlCQUFSLENBQWQ7QUFDQUQsWUFBWUksYUFBWixDQUEwQjtBQUN0QkMsWUFBUSxDQUFDSCxRQUFRSSxLQUFULENBRGM7QUFFdEJDLFdBQU87QUFDSEMs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LG1CQUFPb0MsS0FBS0MsS0FBTCxDQUFXRCxLQUFLeEMsR0FBTCxDQUFTRyxHQUFULEVBQWNxQyxLQUFLckMsR0FBTCxDQUFTbEIsS0FBVCxFQUFnQmUsR0FBaEIsQ0FBZCxJQUFzQ0ksSUFBakQsSUFBeURBLElBQWhFO0FBQ0g7QUEvREk7QUFwQ2EsQ0FBMUIiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgY29tcG9uZW50XzEgPSByZXF1aXJlKFwiLi4vY29tbW9uL2NvbXBvbmVudFwiKTtcclxudmFyIHRvdWNoXzEgPSByZXF1aXJlKFwiLi4vbWl4aW5zL3RvdWNoXCIpO1xyXG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi9jb21tb24vdXRpbHNcIik7XHJcbmNvbXBvbmVudF8xLlZhbnRDb21wb25lbnQoe1xyXG4gICAgbWl4aW5zOiBbdG91Y2hfMS50b3VjaF0sXHJcbiAgICBwcm9wczoge1xyXG4gICAgICAgIGRpc2FibGVkOiBCb29sZWFuLFxyXG4gICAgICAgIHVzZUJ1dHRvblNsb3Q6IEJvb2xlYW4sXHJcbiAgICAgICAgYWN0aXZlQ29sb3I6IFN0cmluZyxcclxuICAgICAgICBpbmFjdGl2ZUNvbG9yOiBTdHJpbmcsXHJcbiAgICAgICAgbWF4OiB7XHJcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgICAgICAgdmFsdWU6IDEwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbWluOiB7XHJcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgICAgICAgdmFsdWU6IDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN0ZXA6IHtcclxuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICAgICAgICB2YWx1ZTogMVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdmFsdWU6IHtcclxuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICAgICAgICB2YWx1ZTogMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYmFySGVpZ2h0OiB7XHJcbiAgICAgICAgICAgIHR5cGU6IG51bGwsXHJcbiAgICAgICAgICAgIHZhbHVlOiAnMnB4J1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB3YXRjaDoge1xyXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh2YWx1ZSwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjcmVhdGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh0aGlzLmRhdGEudmFsdWUpO1xyXG4gICAgfSxcclxuICAgIG1ldGhvZHM6IHtcclxuICAgICAgICBvblRvdWNoU3RhcnQ6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhLmRpc2FibGVkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB0aGlzLnRvdWNoU3RhcnQoZXZlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0VmFsdWUgPSB0aGlzLmZvcm1hdCh0aGlzLmRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLmRyYWdTdGF0dXMgPSAnc3RhcnQnO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25Ub3VjaE1vdmU6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhLmRpc2FibGVkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kcmFnU3RhdHVzID09PSAnc3RhcnQnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdkcmFnLXN0YXJ0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50b3VjaE1vdmUoZXZlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLmRyYWdTdGF0dXMgPSAnZHJhZ2luZyc7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0UmVjdCgnLnZhbi1zbGlkZXInKS50aGVuKGZ1bmN0aW9uIChyZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IF90aGlzLmRlbHRhWCAvIHJlY3Qud2lkdGggKiAxMDA7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5uZXdWYWx1ZSA9IF90aGlzLnN0YXJ0VmFsdWUgKyBkaWZmO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlVmFsdWUoX3RoaXMubmV3VmFsdWUsIGZhbHNlLCB0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvblRvdWNoRW5kOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRhdGEuZGlzYWJsZWQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRyYWdTdGF0dXMgPT09ICdkcmFnaW5nJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh0aGlzLm5ld1ZhbHVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2RyYWctZW5kJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhLmRpc2FibGVkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgbWluID0gdGhpcy5kYXRhLm1pbjtcclxuICAgICAgICAgICAgdGhpcy5nZXRSZWN0KCcudmFuLXNsaWRlcicpLnRoZW4oZnVuY3Rpb24gKHJlY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IChldmVudC5kZXRhaWwueCAtIHJlY3QubGVmdCkgLyByZWN0LndpZHRoICogX3RoaXMuZ2V0UmFuZ2UoKSArIG1pbjtcclxuICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZVZhbHVlKHZhbHVlLCB0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB1cGRhdGVWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBlbmQsIGRyYWcpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSB0aGlzLmZvcm1hdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IHRoaXMuZGF0YSwgYmFySGVpZ2h0ID0gX2EuYmFySGVpZ2h0LCBtaW4gPSBfYS5taW47XHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9ICgodmFsdWUgLSBtaW4pICogMTAwKSAvIHRoaXMuZ2V0UmFuZ2UoKSArIFwiJVwiO1xyXG4gICAgICAgICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgYmFyU3R5bGU6IFwid2lkdGg6IFwiICsgd2lkdGggKyBcIjsgaGVpZ2h0OiBcIiArIHV0aWxzXzEuYWRkVW5pdChiYXJIZWlnaHQpICsgXCI7XCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChkcmFnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdkcmFnJywgeyB2YWx1ZTogdmFsdWUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJywgdmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRSYW5nZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2EgPSB0aGlzLmRhdGEsIG1heCA9IF9hLm1heCwgbWluID0gX2EubWluO1xyXG4gICAgICAgICAgICByZXR1cm4gbWF4IC0gbWluO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZm9ybWF0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gdGhpcy5kYXRhLCBtYXggPSBfYS5tYXgsIG1pbiA9IF9hLm1pbiwgc3RlcCA9IF9hLnN0ZXA7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKE1hdGgubWF4KG1pbiwgTWF0aC5taW4odmFsdWUsIG1heCkpIC8gc3RlcCkgKiBzdGVwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XHJcbiJdfQ==